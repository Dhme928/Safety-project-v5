*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
html,body{height:100%}
body{font-family:system-ui,-apple-system,sans-serif;background:#f0f4f8;color:#1e293b;-webkit-font-smoothing:antialiased;line-height:1.5}

:root{
  --primary:#0891b2;
  --primary-dark:#0e7490;
  --accent-yellow:#ca8a04;
  --accent-green:#16a34a;
  --accent-red:#dc2626;
  --accent-blue:#2563eb;
  --accent-orange:#ea580c;
  --card-bg:#ffffff;
  --card-border:rgba(0,0,0,0.08);
  --surface:#f8fafc;
  --text-main:#1e293b;
  --text-soft:#64748b;
  --nav-bg:#ffffff;
  --shadow:0 4px 6px -1px rgba(0,0,0,0.1);
  --radius:12px;
}

body.dark-mode{
  --card-bg:#1e293b;
  --card-border:rgba(255,255,255,0.1);
  --surface:#0f172a;
  --text-main:#f1f5f9;
  --text-soft:#94a3b8;
  --nav-bg:#1e293b;
  background:#0f172a;
  color:#f1f5f9;
}

.app-container{max-width:600px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column;background:var(--surface)}

.app-header{
  padding:1rem;
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  position:sticky;
  top:0;
  z-index:30;
}
.header-left{display:flex;align-items:center;gap:.75rem}
.header-logo{width:40px;height:40px;border-radius:8px;object-fit:cover;background:#fff}
.header-title h1{font-size:1rem;font-weight:700;line-height:1.2}
.header-title p{font-size:.7rem;opacity:.9}
.header-right{display:flex;align-items:center;gap:.5rem}
.icon-btn{width:36px;height:36px;border-radius:50%;border:none;background:rgba(255,255,255,0.2);color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .2s}
.icon-btn:hover{background:rgba(255,255,255,0.3)}
.points-display{display:flex;align-items:center;gap:.3rem;background:rgba(255,255,255,0.2);padding:.4rem .8rem;border-radius:20px;font-size:.85rem;font-weight:600}
.points-display i{color:#fbbf24}
.user-badge{background:var(--accent-yellow);padding:.15rem .5rem;border-radius:10px;font-size:.7rem;margin-left:.3rem}

.main-content{flex:1;overflow-y:auto;padding:1rem;padding-bottom:5rem}
.tab-content{display:none}
.tab-content.active{display:block}

.bottom-nav{
  position:fixed;
  bottom:0;
  left:50%;
  transform:translateX(-50%);
  max-width:600px;
  width:100%;
  background:var(--nav-bg);
  display:flex;
  padding:.5rem;
  box-shadow:0 -2px 10px rgba(0,0,0,0.1);
  z-index:40;
}
.nav-button{
  flex:1;
  border:none;
  background:transparent;
  color:var(--text-soft);
  padding:.5rem .25rem;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.2rem;
  cursor:pointer;
  font-size:.65rem;
  border-radius:8px;
  transition:all .2s;
}
.nav-button i{font-size:1.1rem}
.nav-button.active{color:var(--primary);background:rgba(8,145,178,0.1)}

.more-menu{
  position:fixed;
  bottom:4.5rem;
  right:1rem;
  max-width:200px;
  background:var(--card-bg);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:.5rem;
  z-index:50;
  border:1px solid var(--card-border);
}
.more-menu button{
  display:flex;
  align-items:center;
  gap:.6rem;
  width:100%;
  padding:.6rem .8rem;
  border:none;
  background:none;
  font-size:.85rem;
  cursor:pointer;
  border-radius:8px;
  color:var(--text-main);
}
.more-menu button:hover{background:var(--surface)}
.more-menu button i{width:20px;color:var(--primary)}

.kpi-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;margin-bottom:1rem}
.kpi-card{border-radius:var(--radius);padding:.75rem;color:#fff;text-align:center;box-shadow:var(--shadow)}
.kpi-obs{background:linear-gradient(135deg,#059669,#10b981)}
.kpi-permits{background:linear-gradient(135deg,#2563eb,#3b82f6)}
.kpi-tbt{background:linear-gradient(135deg,#ea580c,#f97316)}
.kpi-label{font-size:.65rem;text-transform:uppercase;letter-spacing:.05em;opacity:.9}
.kpi-value{font-size:1.5rem;font-weight:700;margin-top:.25rem}

.color-code-row{display:flex;align-items:center;gap:.5rem;margin-bottom:1rem;font-size:.85rem;color:var(--text-soft)}
.month-color-badge{padding:.25rem .75rem;border-radius:20px;font-weight:600;font-size:.8rem;text-transform:uppercase}
.color-red{background:#fee2e2;color:#b91c1c}
.color-blue{background:#dbeafe;color:#1d4ed8}
.color-green{background:#dcfce7;color:#15803d}
.color-yellow{background:#fef3c7;color:#b45309}

.weather-widget{margin-bottom:1rem}
.weather-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem}
.weather-item{background:var(--card-bg);border-radius:var(--radius);padding:.75rem;text-align:center;border:1px solid var(--card-border)}
.weather-item i{font-size:1.5rem;color:var(--primary);margin-bottom:.25rem}
.weather-value{font-size:1.1rem;font-weight:700}
.weather-label{font-size:.7rem;color:var(--text-soft);margin:.25rem 0}
.weather-status{font-size:.75rem;font-weight:600;padding:.2rem .5rem;border-radius:10px;display:inline-block}
.weather-status.safe{background:#dcfce7;color:#16a34a}
.weather-status.caution{background:#fef3c7;color:#b45309}
.weather-status.danger{background:#fee2e2;color:#dc2626}

.home-card{background:var(--card-bg);border-radius:var(--radius);margin-bottom:.75rem;border:1px solid var(--card-border);overflow:hidden}
.home-card-header{display:flex;justify-content:space-between;align-items:center;padding:.75rem;border-bottom:1px solid var(--card-border);font-weight:600;font-size:.9rem}
.home-card-header i{margin-right:.4rem}
.text-yellow{color:var(--accent-yellow)}
.card-link{font-size:.75rem;color:var(--primary);text-decoration:none}
.home-card-body{padding:.75rem}

.leaderboard-mini{display:flex;flex-direction:column;gap:.5rem}
.leaderboard-mini-item{display:flex;align-items:center;gap:.75rem}
.leaderboard-medal{font-size:1.2rem}
.medal-gold{color:#fbbf24}
.medal-silver{color:#9ca3af}
.medal-bronze{color:#b45309}
.leaderboard-name{font-weight:600;font-size:.85rem}
.leaderboard-points{font-size:.75rem;color:var(--text-soft)}
.leaderboard-row{display:flex;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--card-border)}
.leaderboard-rank{width:2rem;font-weight:700;color:var(--primary)}
.leaderboard-row-name{flex:1}
.leaderboard-row-points{font-weight:600;color:var(--accent-yellow)}

.pie-chart-container{padding:.5rem}
.pie-legend{display:flex;flex-direction:column;gap:.4rem}
.legend-item{display:flex;align-items:center;gap:.5rem;font-size:.8rem}
.legend-color{width:12px;height:12px;border-radius:3px}

.bar-chart{display:flex;flex-direction:column;gap:.5rem}
.bar-row{display:flex;flex-direction:column;gap:.2rem}
.bar-label{font-size:.75rem;font-weight:600;color:var(--text-main)}
.bar-wrapper{display:flex;align-items:center;gap:.5rem;height:20px;background:var(--surface);border-radius:4px;overflow:hidden}
.bar-fill{height:100%;border-radius:4px;transition:width .3s ease}
.bar-value{font-size:.75rem;font-weight:600;color:var(--text-soft);min-width:2rem}

.readonly-field{background:var(--surface);color:var(--text-soft);cursor:not-allowed;border-color:var(--border)}
.photo-comparison{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem}
.photo-section{background:var(--surface);border-radius:8px;padding:.5rem}
.photo-section h5{margin:0 0 .5rem;font-size:.85rem;color:var(--text-soft)}
.photo-section img{width:100%;border-radius:4px;cursor:pointer}
.due-date-warning{color:#f59e0b;font-weight:600}
.due-date-overdue{color:#ef4444;font-weight:600}
.action-tracking{background:var(--surface);border-radius:8px;padding:1rem;margin-top:1rem}
.action-tracking h4{margin:0 0 .5rem;display:flex;align-items:center;gap:.5rem}
.action-row{display:flex;justify-content:space-between;padding:.5rem 0;border-bottom:1px solid var(--border)}
.action-row:last-child{border-bottom:none}
.offline-indicator{position:fixed;top:0;left:0;right:0;background:#ef4444;color:#fff;text-align:center;padding:.5rem;font-size:.85rem;z-index:9999;display:none}
.offline-indicator.show{display:block}
.pending-sync-badge{background:#f59e0b;color:#000;border-radius:4px;padding:.2rem .5rem;font-size:.75rem}

.accordion{
  width:100%;
  border:none;
  text-align:left;
  padding:.75rem 1rem;
  margin-top:.5rem;
  border-radius:var(--radius);
  background:linear-gradient(135deg,var(--primary) 0%,var(--primary-dark) 100%);
  color:#fff;
  font-size:.85rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:.5rem;
  cursor:pointer;
  box-shadow:var(--shadow);
}
.accordion i{width:20px;text-align:center}
.panel{
  padding:.75rem 1rem;
  border-radius:0 0 var(--radius) var(--radius);
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-top:none;
  display:none;
  font-size:.85rem;
  margin-bottom:.25rem;
}
.panel ol,.panel ul{padding-left:1.25rem}
.panel li{margin-bottom:.25rem}
.contact-item{display:flex;justify-content:space-between;padding:.4rem 0;border-bottom:1px solid var(--card-border)}
.contact-item a{color:var(--primary);text-decoration:none;font-weight:600}
.useful-link{display:block;padding:.4rem 0;color:var(--primary);text-decoration:none}

.tab-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
.tab-header h2{font-size:1.1rem;font-weight:700}

.btn{display:inline-flex;align-items:center;gap:.4rem;padding:.5rem 1rem;border-radius:8px;border:none;font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s}
.btn-primary{background:var(--primary);color:#fff}
.btn-primary:hover{background:var(--primary-dark)}
.btn-secondary{background:var(--surface);color:var(--text-main);border:1px solid var(--card-border)}
.btn-danger{background:var(--accent-red);color:#fff}
.btn-success{background:var(--accent-green);color:#fff}
.btn-block{width:100%;justify-content:center}
.btn-sm{padding:.35rem .6rem;font-size:.75rem}

.stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;margin-bottom:1rem}
.stat-card{background:var(--card-bg);border-radius:var(--radius);padding:.6rem;text-align:center;border:1px solid var(--card-border)}
.stat-value{font-size:1.25rem;font-weight:700;color:var(--primary);display:block}
.stat-label{font-size:.65rem;color:var(--text-soft);text-transform:uppercase}

.filter-chips{display:flex;gap:.4rem;margin-bottom:.75rem;flex-wrap:wrap}
.obs-filter-chip,.permits-chip,.tbt-chip{
  padding:.4rem .75rem;
  border-radius:20px;
  border:1px solid var(--card-border);
  background:var(--card-bg);
  color:var(--text-soft);
  font-size:.75rem;
  cursor:pointer;
  transition:all .2s;
}
.obs-filter-chip.active,.permits-chip.active,.tbt-chip.active{
  background:var(--primary);
  color:#fff;
  border-color:var(--primary);
}

.filter-row{display:flex;gap:.5rem;margin-bottom:.75rem}
.filter-row select{flex:1;padding:.5rem;border-radius:8px;border:1px solid var(--card-border);background:var(--card-bg);font-size:.8rem}
.search-input{
  width:100%;
  padding:.6rem .75rem;
  border-radius:8px;
  border:1px solid var(--card-border);
  background:var(--card-bg);
  font-size:.85rem;
  margin-bottom:.75rem;
}

.cards-list{display:flex;flex-direction:column;gap:.5rem}
.obs-card{
  position:relative;
  overflow:hidden;
  border-radius:var(--radius);
  background:var(--card-bg);
  padding:.75rem;
  padding-left:1rem;
  border:1px solid var(--card-border);
  cursor:pointer;
  transition:transform .15s,box-shadow .15s;
}
.obs-card:hover{transform:translateY(-2px);box-shadow:var(--shadow)}
.obs-card::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:var(--text-soft)}
.obs-card.risk-high::before{background:var(--accent-red)}
.obs-card.risk-medium::before{background:var(--accent-orange)}
.obs-card.risk-low::before{background:var(--accent-green)}
.obs-card.obs-positive::before{background:var(--accent-green)}
.obs-card.obs-negative::before{background:var(--accent-red)}
.obs-card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:.25rem}
.obs-card-title{font-weight:600;font-size:.9rem}
.obs-card-badges{display:flex;gap:.3rem}
.badge{padding:.15rem .5rem;border-radius:10px;font-size:.65rem;font-weight:600}
.badge-high{background:var(--accent-red);color:#fff}
.badge-medium{background:var(--accent-orange);color:#fff}
.badge-low{background:var(--accent-green);color:#fff}
.status-pill{padding:.15rem .5rem;border-radius:10px;font-size:.65rem;font-weight:600}
.status-open{background:#dcfce7;color:#16a34a}
.status-closed{background:#fee2e2;color:#dc2626}
.obs-card-date{font-size:.75rem;color:var(--text-soft)}
.obs-description{font-size:.8rem;color:var(--text-soft);margin-top:.25rem;line-height:1.4}
.obs-chip-row{display:flex;flex-wrap:wrap;gap:.3rem;margin-top:.4rem}
.obs-chip{padding:.15rem .4rem;border-radius:6px;font-size:.7rem;background:var(--surface);color:var(--text-soft)}
.text-green{color:var(--accent-green)}
.text-red{color:var(--accent-red)}

.library-grid,.tools-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:.75rem;margin-bottom:1rem}
.library-card,.tool-card{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:1rem;
  text-align:center;
  border:1px solid var(--card-border);
  cursor:pointer;
  transition:all .2s;
}
.library-card:hover,.tool-card:hover{background:var(--surface);border-color:var(--primary)}
.library-card i,.tool-card i{font-size:1.5rem;color:var(--primary);margin-bottom:.5rem;display:block}
.library-card span,.tool-card span{font-size:.75rem;font-weight:600}
.library-list{margin-top:.75rem}
.library-item{display:flex;justify-content:space-between;align-items:center;padding:.6rem 0;border-bottom:1px solid var(--card-border)}
.library-item a{color:var(--primary);font-size:.8rem;text-decoration:none}

.tool-section{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:1rem;
  margin-top:1rem;
  border:1px solid var(--card-border);
}
.tool-section h3{font-size:1rem;margin-bottom:.75rem}
.calc-form{display:flex;flex-direction:column;gap:.5rem}
.calc-form label{font-size:.8rem;font-weight:600}
.calc-form input{padding:.5rem;border:1px solid var(--card-border);border-radius:8px}
.calc-result{margin-top:1rem;padding:.75rem;background:var(--surface);border-radius:8px;text-align:center}
.risk-status{font-size:1rem;font-weight:700;margin-top:.25rem}
.risk-matrix{display:table;width:100%;border-collapse:collapse}
.matrix-row{display:table-row}
.matrix-row span{display:table-cell;padding:.4rem;text-align:center;border:1px solid var(--card-border);font-size:.75rem;font-weight:600}
.matrix-row.header span{background:var(--surface)}
.matrix-row span.l{background:#dcfce7;color:#16a34a}
.matrix-row span.m{background:#fef3c7;color:#b45309}
.matrix-row span.h{background:#fed7aa;color:#ea580c}
.matrix-row span.e{background:#fee2e2;color:#dc2626}
.life-saving-list{list-style:none}
.life-saving-list li{display:flex;align-items:center;gap:.5rem;padding:.5rem 0;border-bottom:1px solid var(--card-border);font-size:.85rem}
.life-saving-list i{color:var(--accent-green)}
.challenges-list{display:flex;flex-direction:column;gap:.5rem}
.challenge-card{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:var(--surface);border-radius:8px}
.challenge-info h4{font-size:.85rem;margin-bottom:.2rem}
.challenge-info p{font-size:.75rem;color:var(--text-soft)}
.challenge-points{background:var(--accent-yellow);color:#fff;padding:.3rem .6rem;border-radius:8px;font-weight:700;font-size:.8rem}

.settings-section{background:var(--card-bg);border-radius:var(--radius);padding:1rem;margin-bottom:.75rem;border:1px solid var(--card-border)}
.settings-section h3{font-size:.9rem;font-weight:600;margin-bottom:.75rem;color:var(--text-soft)}
.settings-section h4{font-size:.85rem;margin:1rem 0 .5rem}
.points-display-large{display:flex;align-items:center;justify-content:center;gap:.5rem;font-size:1.5rem;font-weight:700;color:var(--accent-yellow)}
.points-display-large i{font-size:2rem}
.level-display{text-align:center;margin-top:.5rem;color:var(--text-soft)}
.badges-grid{display:flex;flex-wrap:wrap;gap:.5rem}
.badge-card{display:flex;align-items:center;gap:.4rem;padding:.4rem .75rem;background:var(--surface);border-radius:8px;font-size:.8rem;font-weight:600}
.badge-card i{color:var(--accent-yellow)}
.lang-switcher{display:flex;gap:.5rem}
.lang-btn{padding:.5rem 1rem;border:1px solid var(--card-border);border-radius:8px;background:var(--surface);cursor:pointer;font-weight:600;transition:all .2s}
.lang-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
.toggle-switch{display:flex;align-items:center;gap:.75rem;cursor:pointer}
.toggle-switch input{display:none}
.slider{width:40px;height:22px;background:var(--text-soft);border-radius:11px;position:relative;transition:background .2s}
.slider::before{content:"";position:absolute;left:2px;top:2px;width:18px;height:18px;background:#fff;border-radius:50%;transition:transform .2s}
.toggle-switch input:checked + .slider{background:var(--primary)}
.toggle-switch input:checked + .slider::before{transform:translateX(18px)}
.pending-user-card{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:var(--surface);border-radius:8px;margin-bottom:.5rem}
.pending-actions{display:flex;gap:.3rem}

.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.6);z-index:100;align-items:center;justify-content:center;padding:1rem}
.modal.show{display:flex}
.modal-content{background:var(--card-bg);border-radius:var(--radius);padding:1.25rem;max-width:500px;width:100%;max-height:85vh;overflow-y:auto;position:relative}
.modal-large{max-width:600px}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
.modal-header h2{font-size:1.1rem;font-weight:700;display:flex;align-items:center;gap:.5rem}
.modal-header i{color:var(--accent-yellow)}
.close-btn{width:28px;height:28px;border-radius:50%;border:none;background:var(--surface);font-size:1.2rem;cursor:pointer;display:flex;align-items:center;justify-content:center}
.modal-auth{text-align:center}

.auth-tabs{display:flex;gap:.5rem;margin-bottom:1rem}
.auth-tab{flex:1;padding:.5rem;border:none;background:var(--surface);border-radius:8px;cursor:pointer;font-weight:600;transition:all .2s}
.auth-tab.active{background:var(--primary);color:#fff}
.auth-form{display:flex;flex-direction:column;gap:.6rem}
.auth-form input{padding:.6rem .75rem;border:1px solid var(--card-border);border-radius:8px;font-size:.9rem}
.error-text{color:var(--accent-red);font-size:.8rem;min-height:1rem}
.auth-message{padding:.75rem;border-radius:8px;margin-bottom:.75rem}
.auth-message.success{background:#dcfce7;color:#16a34a}

.form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:.75rem}
.form-group{display:flex;flex-direction:column;gap:.25rem}
.form-group.full-width{grid-column:1/-1}
.form-group label{font-size:.8rem;font-weight:600;color:var(--text-soft)}
.form-group input,.form-group select,.form-group textarea{padding:.5rem .6rem;border:1px solid var(--card-border);border-radius:8px;font-size:.85rem;background:var(--card-bg)}
.form-row{display:flex;gap:.75rem;grid-column:1/-1}
.form-row .form-group{flex:1}
.form-actions{grid-column:1/-1;display:flex;gap:.5rem;justify-content:flex-end;margin-top:.5rem}

.detail-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:.5rem;margin-bottom:1rem}
.detail-row{display:flex;flex-direction:column;padding:.4rem 0}
.detail-label{font-size:.7rem;color:var(--text-soft);text-transform:uppercase}
.detail-section{margin:1rem 0}
.detail-section h4{font-size:.85rem;color:var(--primary);margin-bottom:.25rem}
.detail-section p{font-size:.85rem;line-height:1.5}
.evidence-gallery{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.75rem}
.evidence-gallery img{width:80px;height:80px;object-fit:cover;border-radius:8px;cursor:pointer;border:1px solid var(--card-border)}
.modal-actions{display:flex;gap:.5rem;justify-content:flex-end;margin-top:1rem}

.news-item{padding:.75rem;background:var(--surface);border-radius:8px;margin-bottom:.5rem;border-left:4px solid var(--primary)}
.news-item.priority-urgent{border-color:var(--accent-orange)}
.news-item.priority-critical{border-color:var(--accent-red)}
.news-item h4{font-size:.9rem;margin-bottom:.25rem}
.news-item p{font-size:.8rem;color:var(--text-soft)}
.news-meta{font-size:.7rem;color:var(--text-soft);margin-top:.5rem}

[dir="rtl"] .obs-card{padding-left:.75rem;padding-right:1rem}
[dir="rtl"] .obs-card::before{left:auto;right:0}
[dir="rtl"] .header-left{flex-direction:row-reverse}
[dir="rtl"] .form-actions{flex-direction:row-reverse}

@media(max-width:400px){
  .kpi-grid,.stats-row{grid-template-columns:repeat(2,1fr)}
  .library-grid,.tools-grid{grid-template-columns:repeat(2,1fr)}
  .form-grid{grid-template-columns:1fr}
  .detail-grid{grid-template-columns:1fr}
}
